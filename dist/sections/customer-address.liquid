<div class="mx-auto max-w-6xl px-4 py-12">
  <div class="my-5 flex flex-col items-center justify-between gap-4 md:flex-row">
    <h1 class="text-2xl font-bold text-primary">Addresses</h1>
    <button
      class="rounded bg-gray-700 px-6 py-2 font-medium text-white hover:bg-gray-900"
      type="button"
      x-on:click="new_address = true"
    >
      Create new address
    </button>
    <a href="{{ routes.account_url }}" class="text-primary-600 hover:text-primary-800 font-medium underline">Back to account</a>
  </div>
  <div
    class="
      fixed inset-0 z-50 h-full w-full overflow-y-auto bg-gray-600
      bg-opacity-50
    "
    x-show="new_address"
  >
    <div class="relative top-20 mx-auto max-w-md border bg-white p-4">
      <div class="mb-4 flex items-center justify-between">
        <h2 class="text-lg font-medium">New address</h2>
        <button class="rounded text-gray-500" x-on:click="new_address = false">Close</button>
      </div>
      {% form 'customer_address', customer.new_address %}
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_fname_{{ form.id }}"
            >First name</label
          >
          <input
            type="text"
            name="address[first_name]"
            id="address_fname_{{ form.id }}"
            value="{{ form.first_name }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_lname_{{ form.id }}"
            >Last name</label
          >
          <input
            type="text"
            name="address[last_name]"
            id="address_lname_{{ form.id }}"
            value="{{ form.last_name }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_company_{{ form.id }}"
            >Company</label
          >
          <input
            type="text"
            name="address[company]"
            id="address_company_{{ form.id }}"
            value="{{ form.company }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_address1_{{ form.id }}"
            >Address 1</label
          >
          <input
            type="text"
            name="address[address1]"
            id="address_address1_{{ form.id }}"
            value="{{ form.address1 }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_address2_{{ form.id }}"
            >Address 2</label
          >
          <input
            type="text"
            name="address[address2]"
            id="address_address2_{{ form.id }}"
            value="{{ form.address2 }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_city_{{ form.id }}"
            >City</label
          >
          <input
            type="text"
            name="address[city]"
            id="address_city_{{ form.id }}"
            value="{{ form.city }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_country_{{ form.id }}"
            >Country</label
          >
          <select
            name="address[country]"
            id="address_country_{{ form.id }}"
            value="{{ form.country }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
            data-country-selector
            data-id="{{ form.id }}"
          >
            {{ all_country_option_tags }}
          </select>
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_province_{{ form.id }}"
            >State</label
          >
          <select
            name="address[province]"
            id="address_province_{{ form.id }}"
            value="{{ form.province }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          ></select>
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_zip_{{ form.id }}"
            >Postal/ZIP code</label
          >
          <input
            type="text"
            name="address[zip]"
            id="address_zip_{{ form.id }}"
            value="{{ form.zip }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_phone_{{ form.id }}"
            >Phone number</label
          >
          <input
            type="tel"
            name="address[phone]"
            id="address_phone_{{ form.id }}"
            value="{{ form.phone }}"
            class="w-full border px-4 py-3 text-primary focus:outline-none"
          >
        </div>
        <div class="mb-4">
          {{ form.set_as_default_checkbox }}
          <label
            class="mb-2 text-xs font-medium uppercase text-primary"
            for="address_default_address_{{ form.id }}"
            >Set as default address</label
          >
        </div>
        <div class="flex flex-row gap-2">
          <button
            class="
              w-full rounded bg-gray-700 px-4 py-2 font-medium text-white
              hover:bg-gray-900
            "
            type="submit"
          >
            Create address
          </button>
          <button
            class="
              w-full rounded border border-gray-700 px-4 py-2 font-medium
              text-primary
            "
            type="reset"
          >
            Cancel
          </button>
        </div>
      {% endform %}
    </div>
  </div>
  <div>
    {% paginate customer.addresses by 10 %}
      <div
        class="
          grid grid-cols-1 gap-4 p-4 md:grid-cols-2 md:p-12 lg:grid-cols-4
          lg:gap-12
        "
      >
        {% for address in customer.addresses %}
          <div>
            <div class="relative flex flex-col border p-2 text-center">
              {% if address == customer.default_address %}
                <span class="bg-success-bg-700 px-4 py-2 text-xs font-medium text-white">Default</span>
              {% endif %}
              <div class="my-8 h-full">
                {{ address | format_address }}
              </div>
              <div class="flex flex-row gap-2">
                <button
                  class="w-full bg-gray-700 py-2 text-xs font-medium text-white hover:bg-gray-900"
                  x-on:click="address_{{ address.id }} = true"
                >
                  Edit
                </button>
                <button class="w-full border py-2 text-xs font-medium text-primary" data-url="{{ address.url }}" data-delete-address>Delete</button>
              </div>
              <form method="post" action="{{ address.url }}">
                <input name="_method" type="hidden" value="delete">
              </form>
            </div>
            <div
              class="
                fixed inset-0 z-50 h-full w-full overflow-y-auto bg-gray-600
                bg-opacity-50
              "
              x-show="address_{{ address.id }}"
            >
              <div class="relative top-20 bottom-20 mx-auto max-w-md border bg-white p-4">
                <div class="mb-4 flex items-center justify-between">
                  <h2 class="text-lg font-medium">Edit address</h2>
                  <button class="text-gray-500" x-on:click="address_{{ address.id }} = false">Close</button>
                </div>
                {% form 'customer_address', address %}
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_fname_{{ form.id }}"
                      >First name</label
                    >
                    <input
                      type="text"
                      name="address[first_name]"
                      id="address_fname_{{ form.id }}"
                      value="{{ form.first_name }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_lname_{{ form.id }}"
                      >Last name</label
                    >
                    <input
                      type="text"
                      name="address[last_name]"
                      id="address_lname_{{ form.id }}"
                      value="{{ form.last_name }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_company_{{ form.id }}"
                      >Company</label
                    >
                    <input
                      type="text"
                      name="address[company]"
                      id="address_company_{{ form.id }}"
                      value="{{ form.company }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_address1_{{ form.id }}"
                      >Address 1</label
                    >
                    <input
                      type="text"
                      name="address[address1]"
                      id="address_address1_{{ form.id }}"
                      value="{{ form.address1 }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_address2_{{ form.id }}"
                      >Address 2</label
                    >
                    <input
                      type="text"
                      name="address[address2]"
                      id="address_address2_{{ form.id }}"
                      value="{{ form.address2 }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_city_{{ form.id }}"
                      >City</label
                    >
                    <input
                      type="text"
                      name="address[city]"
                      id="address_city_{{ form.id }}"
                      value="{{ form.city }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_country_{{ form.id }}"
                      >Country</label
                    >
                    <select
                      name="address[country]"
                      id="address_country_{{ form.id }}"
                      value="{{ form.country }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                      data-country-selector
                      data-id="{{ form.id }}"
                    >
                      {{ all_country_option_tags }}
                    </select>
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_province_{{ form.id }}"
                      >Province</label
                    >
                    <select
                      name="address[province]"
                      id="address_province_{{ form.id }}"
                      value="{{ form.province }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    ></select>
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_zip_{{ form.id }}"
                      >Postal/ZIP code</label
                    >
                    <input
                      type="text"
                      name="address[zip]"
                      id="address_zip_{{ form.id }}"
                      value="{{ form.zip }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_phone_{{ form.id }}"
                      >Phone number</label
                    >
                    <input
                      type="tel"
                      name="address[phone]"
                      id="address_phone_{{ form.id }}"
                      value="{{ form.phone }}"
                      class="w-full border px-4 py-3 text-primary focus:outline-none"
                    >
                  </div>
                  <div class="mb-4">
                    {{ form.set_as_default_checkbox }}
                    <label
                      class="mb-2 text-xs font-medium uppercase text-primary"
                      for="address_default_address_{{ form.id }}"
                      >Set as default address</label
                    >
                  </div>
                  <div class="flex flex-row gap-2">
                    <button
                      class="
                        w-full rounded bg-gray-700 px-4 py-2 font-medium text-white
                        hover:bg-gray-900
                      "
                      type="submit"
                    >
                      Edit address
                    </button>
                    <button
                      class="
                        w-full rounded border border-gray-700 px-4 py-2 font-medium
                        text-primary
                      "
                      type="reset"
                    >
                      Cancel
                    </button>
                  </div>
                {% endform %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endpaginate %}
  </div>
</div>

{%- capture src_url -%}
  {{- 'section-customer-address.js' | asset_url -}}
{%- endcapture -%}
{%- render 'atom_script', src: src_url, priority: 'normal', type: 'defer' -%}
