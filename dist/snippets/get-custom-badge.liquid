{%- capture custom_badge -%}
  [
    {%- for mod_tag in shop.metafields.custom_badge.tag -%}
      {%- assign mod_text = shop.metafields.custom_badge.text[forloop.index0] -%}
      {%- assign mod_background_color = shop.metafields.custom_badge.background_color[forloop.index0] -%}
      {%- assign mod_text_color = shop.metafields.custom_badge.text_colour[forloop.index0] -%}
      {%- assign mod_class_name = shop.metafields.custom_badge.class_name[forloop.index0] -%}
      {%- assign mod_hide_on_cart = shop.metafields.custom_badge.hide_on_cart[forloop.index0] -%}
      {
        tag: {{- mod_tag | json -}},
        text: {{- mod_text | json -}},
        backgroundColor: {{- mod_background_color | json -}},
        textColor: {{- mod_text_color | json -}},
        customClass: {{- mod_class_name | json -}},
        hideOnCart: {%- if mod_hide_on_cart == 'true' -%}true{%- else-%}false{%- endif -%}
      }{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ]
{%- endcapture -%}

{
  "items": {{- custom_badge -}},
  "tags": {{ shop.metafields.custom_badge.tag | json }},
  "ignore": {{ shop.metafields.custom_badge.prefix | split: '|' | json }}
}
